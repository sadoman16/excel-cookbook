---
title: Master the XLOOKUP Recipe for Perfect Excel Lookups
description: Learn to effortlessly find data in Excel with the XLOOKUP function. This recipe guides you through syntax, real-world examples, and common fixes.
date: 2026-02-15
tags: [Excel, XLOOKUP, Lookup & Reference, Data Analysis, Productivity]
---

## The Problem

Picture this: it's Monday morning, and your manager needs a consolidated report. You have a list of product IDs in one sheet and their corresponding prices, suppliers, and colors scattered across three other tabs. Manually copying and pasting each piece of information feels like trying to herd cats – time-consuming, prone to errors, and frankly, a waste of your valuable time. You're stuck trying to reconcile disparate data, and the clock is ticking.

You need a way to quickly and accurately pull specific details based on a common identifier, no matter where that information lives in your workbook. You’ve heard whispers of powerful Excel functions, but `VLOOKUP` feels rigid, and `INDEX/MATCH` combinations seem overly complex for a quick fix. You need a modern, versatile solution that simplifies data retrieval. This is precisely where the elegant **XLOOKUP** function steps in, ready to revolutionize how you connect your data.

## The Ingredients: Understanding XLOOKUP's Setup

Think of **XLOOKUP** as your sous chef, ready to fetch exactly what you need from your data pantry. Its syntax is straightforward, yet incredibly powerful, allowing you to search for a value and return a corresponding item from a different column.

Here's the essential structure for our recipe:

`=XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])`

Let's break down each parameter, much like preparing your ingredients before cooking:

| Parameter         | Description                                                                                                                                                                                                                                   |
| :---------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **lookup_value**  | This is the item you're searching for. It could be a product ID, an employee name, or a date – whatever unique identifier you want to find.                                                                                                    |
| **lookup_array**  | The range or array where `XLOOKUP` will search for your `lookup_value`. This is your list of unique identifiers.                                                                                                                             |
| **return_array**  | The range or array from which you want to retrieve the corresponding result. Once `XLOOKUP` finds the `lookup_value` in the `lookup_array`, it will fetch the item at the same position in this `return_array`.                               |
| **[if_not_found]**| **(Optional)** A custom value or text to return if `XLOOKUP` can't find the `lookup_value`. This is a fantastic feature for preventing unsightly `#N/A` errors and making your spreadsheets user-friendly.                                     |
| **[match_mode]**  | **(Optional)** Specifies the type of match to perform: <br> `0` = Exact match (default). <br> `-1` = Exact match or next smaller item. <br> `1` = Exact match or next larger item. <br> `2` = Wildcard character match.                     |
| **[search_mode]** | **(Optional)** Determines the search direction: <br> `1` = Search from first to last item (default). <br> `-1` = Search from last to first item. <br> `2` = Binary search, sorted ascending (requires `lookup_array` to be sorted). <br> `-2` = Binary search, sorted descending (requires `lookup_array` to be sorted). |

Understanding these "ingredients" is the first step to mastering the powerful **XLOOKUP** function.

## The Recipe: Step-by-Step Instructions

Let’s whip up a practical example. Imagine you have a main sales report (Sheet1) with "Product ID" and "Quantity Sold," but you need to pull in the "Product Name" and "Unit Price" from your product catalog (Sheet2).

**Sheet1: Sales Data**

| Product ID | Quantity Sold | Product Name | Unit Price |
| :--------- | :------------ | :----------- | :--------- |
| P001       | 150           |              |            |
| P003       | 210           |              |            |
| P005       | 80            |              |            |
| P002       | 300           |              |            |
| P004       | 120           |              |            |
| P006       | 50            |              |            |

**Sheet2: Product Catalog**

| SKU  | Product Name       | Category  | Unit Price | Stock Level |
| :--- | :----------------- | :-------- | :--------- | :---------- |
| P001 | Wireless Mouse     | Peripherals | 25.99      | 500         |
| P002 | Mechanical Keyboard| Peripherals | 89.99      | 300         |
| P003 | 27-inch Monitor    | Displays  | 199.99     | 200         |
| P004 | USB-C Hub          | Accessories | 39.99      | 450         |
| P005 | Web Camera         | Peripherals | 49.99      | 150         |

Our goal is to populate "Product Name" (column C) and "Unit Price" (column D) in Sheet1 using `XLOOKUP`.

### Step 1: Find the Product Name

1.  **Select the cell** where you want the first "Product Name" to appear (C2 in Sheet1).
2.  **Identify your `lookup_value`**: This is "P001" in cell A2 of Sheet1.
3.  **Identify your `lookup_array`**: This is the "SKU" column in Sheet2 (B:B, or specifically B2:B6 if your data has headers).
4.  **Identify your `return_array`**: This is the "Product Name" column in Sheet2 (C:C, or C2:C6).
5.  **Construct the basic `XLOOKUP` formula**: `=XLOOKUP(A2, Sheet2!B2:B6, Sheet2!C2:C6)`
6.  **Add the `if_not_found` argument**: Let's specify "Not Found" if a Product ID isn't in our catalog. This is a common best practice we always recommend for a clean spreadsheet.
    The formula becomes: `=XLOOKUP(A2, Sheet2!B2:B6, Sheet2!C2:C6, "Not Found")`
7.  **Press Enter**. Cell C2 will now display "Wireless Mouse".
8.  **Drag the fill handle** down to apply the formula to the rest of column C.

### Step 2: Find the Unit Price

1.  **Select the cell** for the first "Unit Price" (D2 in Sheet1).
2.  **Your `lookup_value` is still** "P001" in cell A2 of Sheet1.
3.  **Your `lookup_array` is still** the "SKU" column in Sheet2 (B2:B6).
4.  **Your `return_array` is now** the "Unit Price" column in Sheet2 (E2:E6).
5.  **Construct the `XLOOKUP` formula**: `=XLOOKUP(A2, Sheet2!B2:B6, Sheet2!E2:E6, "Price N/A")`
6.  **Press Enter**. Cell D2 will show "25.99".
7.  **Drag the fill handle** down to populate the rest of column D.

Your Sheet1 will now look like this, cleanly populated by the power of `XLOOKUP`:

**Sheet1: Sales Data (After XLOOKUP)**

| Product ID | Quantity Sold | Product Name       | Unit Price |
| :--------- | :------------ | :----------------- | :--------- |
| P001       | 150           | Wireless Mouse     | 25.99      |
| P003       | 210           | 27-inch Monitor    | 199.99     |
| P005       | 80            | Web Camera         | 49.99      |
| P002       | 300           | Mechanical Keyboard| 89.99      |
| P004       | 120           | USB-C Hub          | 39.99      |
| P006       | 50            | Not Found          | Price N/A  |

Notice how `XLOOKUP` gracefully handled "P006," which wasn't in our product catalog, returning our custom "Not Found" and "Price N/A" messages instead of an error. This is a testament to its robust design.

## Pro Tips: Level Up Your Skills

Think of these as the secret spices that elevate your `XLOOKUP` dishes from good to gourmet.

*   **Always provide the `if_not_found` argument** to avoid ugly #N/A errors. XLOOKUP can look left (unlike VLOOKUP) and defaults to exact match, so no need to remember FALSE. This single tip will make your spreadsheets far more professional and user-friendly.

*   **Wildcard Wonders:** Need to find something that "contains" a specific text? Utilize the `[match_mode]` of `2` for wildcard searches. For example, `=XLOOKUP("*\Keyboard*", B:B, C:C, "No Match", 2)` would find any product name containing "Keyboard". Remember to use `*` for any sequence of characters and `?` for any single character.

*   **Approximate Matches for Tiered Pricing:** When dealing with commission structures, tax brackets, or tiered pricing, the `[match_mode]` arguments of `-1` (exact or next smaller) or `1` (exact or next larger) are invaluable. This allows `XLOOKUP` to find the correct tier even if an exact match isn't present, a capability that often required more complex formulas in older Excel versions.

*   **Looking Left is Simple:** Unlike its predecessor `VLOOKUP`, **XLOOKUP** doesn't care if your `lookup_array` is to the left or right of your `return_array`. This flexibility is a huge time-saver and makes your data organization less constrained. Experienced Excel users often cite this as one of the top reasons they prefer **XLOOKUP**.

## Troubleshooting: Common Errors & Fixes

Even the best chefs occasionally face culinary mishaps. Here’s how to fix common **XLOOKUP** errors:

### 1. #N/A Error

*   **What it looks like:** `#N/A`
*   **Why it happens:** This error appears when **XLOOKUP** cannot find the `lookup_value` in the `lookup_array`, and you haven't specified an `[if_not_found]` argument. It's like asking for a specific ingredient that isn't in your pantry.
*   **How to fix it:** The simplest and most elegant solution is to always include the `[if_not_found]` argument. For example, instead of `=XLOOKUP(A2, B:B, C:C)`, use `=XLOOKUP(A2, B:B, C:C, "Item Not Found")`. This transforms an error into a clear, custom message.

### 2. #VALUE! Error

*   **What it looks like:** `#VALUE!`
*   **Why it happens:** A common mistake we've seen is when your `lookup_array` and `return_array` have different dimensions (sizes or shapes). For instance, if you select `B1:B10` for your `lookup_array` but `C1:D10` for your `return_array`, **XLOOKUP** gets confused because it expects a single column or row for each array.
*   **How to fix it:** Ensure both your `lookup_array` and `return_array` cover the same number of rows or columns. If your `lookup_array` is `B2:B100`, your `return_array` should be a single column of `C2:C100` (or `D2:D100`, etc.), not a multi-column range.

### 3. #NAME? Error

*   **What it looks like:** `#NAME?`
*   **Why it happens:** This error occurs when Excel doesn't recognize the function name itself. The most frequent cause is trying to use **XLOOKUP** in an older version of Excel (pre-Microsoft 365, Excel 2019, or Excel for the web). `XLOOKUP` was introduced relatively recently.
*   **How to fix it:**
    1.  **Upgrade your Excel version:** The ideal solution is to upgrade to Microsoft 365. This ensures you have access to the latest functions and features.
    2.  **Use an alternative:** If an upgrade isn't immediately possible, you'll need to use older lookup functions like `VLOOKUP` (with its limitations) or the more versatile `INDEX` and `MATCH` combination, which can replicate most `XLOOKUP` functionality but with more nested formulas. According to Microsoft documentation, `XLOOKUP` is the preferred modern choice for its simplicity and power.

## Quick Reference

Before you head back to your data kitchen, here's a swift reminder of our `XLOOKUP` recipe's highlights:

*   **Syntax:** `=XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])`
*   **Most Common Use Case:** Retrieving specific information (e.g., price, name, ID) from a table based on a unique identifier. Perfect for consolidating reports or enriching data.
*   **Key Gotcha to Avoid:** Forgetting the `if_not_found` argument – always add it for cleaner outputs and better user experience. Remember, **XLOOKUP** defaults to an exact match, which is what most users need.
*   **Related Functions to Explore:**
    *   `VLOOKUP`: The predecessor, still useful for simple right-hand lookups.
    *   `HLOOKUP`: For horizontal lookups (where your data is in rows instead of columns).
    *   `INDEX` & `MATCH`: A powerful combination that can achieve almost anything `XLOOKUP` can, offering maximum flexibility in older Excel versions.

With this **XLOOKUP** cookbook recipe in hand, you're now equipped to tackle complex data lookups with confidence and precision. Happy Excelling!