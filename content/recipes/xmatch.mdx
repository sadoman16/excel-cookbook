---
title: "XMATCH Masterclass: Precisely Locate Data in Your Excel Cookbook"
description: "Unlock the power of Excel's XMATCH function to find exact or approximate matches and streamline your data lookups. A flexible alternative to MATCH."
date: "2026-02-21"
tags: ["Excel", "XMATCH", "Dynamic Array / Lookup & Reference", "Data Lookup", "Match Function"]
---

## The Problem

Are you constantly battling with spreadsheets, trying to find the exact position of an item in a list, only to be frustrated by limitations or cryptic errors? Perhaps you're tasked with locating a specific product ID within a sprawling inventory sheet, or pinpointing an employee's record among thousands, and the built-in lookup tools feel clunky or insufficient. This is a common pain point for many Excel users, leading to wasted time and potential data entry errors.

What is XMATCH? XMATCH is an Excel function that searches for a specified item in an array or range of cells, then returns the item's relative position. It is commonly used to dynamically find the row or column number of a lookup value, often as a component of more complex formulas like INDEX-XMATCH combinations. For those needing advanced lookup capabilities beyond the traditional MATCH function, XMATCH provides a powerful and flexible solution.

You might be thinking, "There has to be a better way than manually scanning rows or using an outdated function that just doesn't quite fit my needs!" XMATCH is precisely that better way, offering enhanced flexibility, especially when dealing with approximate matches, wildcard characters, or even needing to search a list in reverse order. It's time to upgrade your lookup game.

## Business Context & Real-World Use Case

In the fast-paced world of supply chain management, reconciling inventory records against shipment manifests is a daily critical task. Imagine a logistics manager receiving a large shipment, needing to verify that every product code listed on the manifest matches an existing product in their internal database, and identify its storage location. Manually sifting through thousands of product codes to find discrepancies or confirm positions can lead to significant delays, stock inaccuracies, and ultimately, costly operational errors.

In my years as a data analyst, I've seen teams waste countless hours trying to manually cross-reference vast datasets. A common mistake we've seen is relying on simple VLOOKUPs that return only the first match, missing duplicate entries or requiring complex workarounds. This manual approach not only consumes valuable time but also introduces a high risk of human error, potentially leading to incorrect stock levels, missed orders, or inaccurate financial reporting. Automating this with XMATCH ensures rapid, precise identification of data, drastically reducing reconciliation time and improving overall data integrity. The business value here is immense: faster processing, fewer errors, and more reliable inventory insights.

Consider a scenario where you need to quickly find if a particular "SKU-90034-BLUE" product code exists in a list of over 10,000 items and, if so, which row it's on to then pull additional details. Or perhaps you need to find the *last* instance of a product because you're tracking recent movements. XMATCH empowers you to handle these complex lookup requirements with ease, transforming a tedious, error-prone task into an efficient, automated process that fuels better business decisions.

## The Ingredients: Understanding XMATCH's Setup

To truly master XMATCH, think of it as a versatile tool with several settings, each designed for a specific purpose. Understanding its core components is crucial for crafting robust and precise lookup formulas.

The exact syntax for the XMATCH function is:

`XMATCH(lookup_value, lookup_array, [match_mode], [search_mode])`

Let's break down each parameter:

| Parameter      | Description                                                                                                                                                                                                    |
| :------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `lookup_value` | **The Value to Search For:** This is the specific item you want to find. It can be a number, text string, logical value, or a cell reference containing one of these.                                              |
| `lookup_array` | **The Array or Range to Search Within:** This is the single row or column where you expect to find your `lookup_value`. XMATCH can only search in one dimension at a time (a row *or* a column, not a full table). |
| `[match_mode]` | **Optional. How Exact Should the Match Be?** Controls the type of match XMATCH performs. If omitted, the default is `0` (exact match). <br> `-1`: Exact match or next smaller item.<br> `0`: Exact match (default).<br> `1`: Exact match or next larger item.<br> `2`: Wildcard character match.                                      |
| `[search_mode]` | **Optional. How Should the Search Proceed?** Determines the direction and method of the search. If omitted, the default is `1` (search from first to last). <br> `1`: Search from first to last (default).<br> `-1`: Search from last to first.<br> `2`: Binary search (lookup_array must be sorted ascending).<br> `-2`: Binary search (lookup_array must be sorted descending). |

Understanding these parameters is your first step to becoming an XMATCH expert. The optional `match_mode` and `search_mode` are where XMATCH truly shines, offering capabilities far beyond its predecessor, the MATCH function.

## The Recipe: Step-by-Step Instructions

Let's dive into a practical example. Imagine you're managing a bookstore's inventory and need to quickly locate specific book titles or their ISBNs within your catalog to find their shelf position.

Here's a sample of your `Book Inventory` data:

| ID  | Book Title               | ISBN            | Category  | Stock |
| :-- | :----------------------- | :-------------- | :-------- | :---- |
| 101 | The Excel Cookbook       | 978-0123456789  | Software  | 50    |
| 102 | Data Analysis for Dummies| 978-9876543210  | Software  | 30    |
| 103 | Mastering VBA            | 978-1122334455  | Programming | 20    |
| 104 | Financial Modeling Basics| 978-5544332211  | Finance   | 45    |
| 105 | Agile Project Management | 978-6789012345  | Management | 25    |
| 106 | The Art of Storytelling  | 978-2233445566  | Fiction   | 60    |

Let's say this data is in cells `A1:E7`. You want to find the row number for "Mastering VBA".

### Scenario 1: Exact Match (Default Behavior)

1.  **Prepare Your Data:** Ensure your `Book Inventory` table is in a sheet, for instance, `A1:E7`.
2.  **Choose Your Lookup Value:** In a separate cell (e.g., `G2`), type the book title you want to find: `Mastering VBA`.
3.  **Select Your Result Cell:** Click on the cell where you want the row number to appear (e.g., `H2`).
4.  **Enter the XMATCH Formula:** Type the following formula into `H2`:
    `=XMATCH(G2, B2:B7)`
5.  **Press Enter:** The result will be `3`. This means "Mastering VBA" is the 3rd item in the `B2:B7` range (Excel considers the range's start as position 1).

### Scenario 2: Reverse Search for the Last Occurrence

What if you had duplicate titles and wanted the *last* one added? XMATCH can do this effortlessly.

1.  **Add Duplicate Data:** Let's assume you added "The Excel Cookbook" again at the end, making your data `B2:B8` and "The Excel Cookbook" now appears at position 1 and position 7 in the `B2:B8` range.
    *   Row 2: The Excel Cookbook
    *   ...
    *   Row 8: The Excel Cookbook
2.  **Choose Your Lookup Value:** In `G3`, type `The Excel Cookbook`.
3.  **Select Your Result Cell:** Click on `H3`.
4.  **Enter the XMATCH Formula with `search_mode`:** Type the following formula into `H3`:
    `=XMATCH(G3, B2:B8, 0, -1)`
    *   Here, `0` specifies an exact match, and `-1` tells XMATCH to search from the last item to the first.
5.  **Press Enter:** The result will be `7`. This indicates that "The Excel Cookbook" is found at the 7th relative position when searching from the bottom up in the `B2:B8` range. This is incredibly powerful for tracking recent entries or last known statuses.

### Scenario 3: Wildcard Match for Partial Text

Sometimes you only have part of the title. XMATCH allows wildcard characters.

1.  **Choose Your Partial Lookup Value:** In `G4`, type `*Project*` (the asterisks are wildcards representing any sequence of characters).
2.  **Select Your Result Cell:** Click on `H4`.
3.  **Enter the XMATCH Formula with `match_mode`:** Type the following formula into `H4`:
    `=XMATCH(G4, B2:B7, 2)`
    *   Here, `2` specifies a wildcard character match.
4.  **Press Enter:** The result will be `5`. This correctly identifies "Agile Project Management" as the 5th item in the list. This function is a lifesaver when dealing with inconsistent data entries.

The XMATCH function truly elevates your lookup capabilities, offering precision and flexibility for a wide array of data challenges.

## Pro Tips: Level Up Your Skills

Mastering XMATCH isn't just about syntax; it's about knowing how to leverage its full potential for maximum efficiency.

Use XMATCH as a flexible alternative to MATCH, especially when needing approximate matches or reverse searches. While MATCH offers similar functionality, XMATCH simplifies the syntax for these advanced scenarios and is more intuitive to use.

*   **Combine with INDEX:** The most powerful use of XMATCH is often in tandem with the INDEX function. While XMATCH tells you the *position* of an item, INDEX can then use that position to return a *value* from another column or row. For example, `=INDEX(C2:C7, XMATCH(G2, B2:B7, 0))` would return the ISBN for "Mastering VBA". Experienced Excel users prefer this INDEX-XMATCH combination over VLOOKUP for its flexibility and ability to look left.
*   **Dynamic Array Spill:** Since XMATCH is a dynamic array function, if your `lookup_value` is a range of multiple items (e.g., `G2:G4`), XMATCH will spill the results for each lookup value into adjacent cells, making bulk lookups incredibly efficient. This capability is a game-changer for processing lists.
*   **Case Sensitivity:** By default, XMATCH is not case-sensitive. If you need a case-sensitive match, you can combine XMATCH with functions like EXACT or use array formulas, although this adds complexity. For most standard lookups, the default behavior is perfectly adequate.

## Troubleshooting: Common Errors & Fixes

Even the most seasoned Excel chefs occasionally face a kitchen disaster. Here are common XMATCH errors and how to fix them.

### 1. #N/A Error

*   **Symptom:** The formula returns `#N/A` (Not Available).
*   **Cause:** This is the most common error and almost always means that the `lookup_value` could not be found within the `lookup_array`. This could be due to several reasons:
    *   **Misspelling:** The lookup value is typed incorrectly or has different casing (though XMATCH is generally not case-sensitive, exact mismatches still apply).
    *   **Leading/Trailing Spaces:** The lookup value or items in the `lookup_array` might have invisible leading or trailing spaces.
    *   **Data Type Mismatch:** You might be searching for a number stored as text, or vice-versa.
    *   **Incorrect `lookup_array` Range:** The range specified for `lookup_array` might not actually contain the value you're looking for, or it might be too small.
*   **Step-by-Step Fix:**
    1.  **Double-Check Spelling:** Carefully compare your `lookup_value` with the items in `lookup_array`.
    2.  **Trim Spaces:** Use the `TRIM` function on both your `lookup_value` and potentially the `lookup_array` (or a helper column for the array) to remove unwanted spaces. For example: `=XMATCH(TRIM(G2), TRIM(B2:B7))` (if `B2:B7` is a range of text, this may require Ctrl+Shift+Enter for older Excel versions or a helper column).
    3.  **Verify Data Types:** Use `ISTEXT()` and `ISNUMBER()` to check the data types of your `lookup_value` and `lookup_array` entries. Convert as needed using `VALUE()` or `TEXT()`.
    4.  **Expand Range:** Ensure your `lookup_array` encompasses all possible locations where your `lookup_value` could reside.

### 2. #VALUE! Error

*   **Symptom:** The formula returns `#VALUE!`.
*   **Cause:** This error typically indicates a problem with one of the optional `match_mode` or `search_mode` arguments. You've likely entered a number that XMATCH doesn't recognize for these parameters. For instance, using `3` for `match_mode` instead of `-1`, `0`, `1`, or `2`.
*   **Step-by-Step Fix:**
    1.  **Review Parameters:** Carefully check the numbers used for `match_mode` and `search_mode`.
    2.  **Consult Syntax:** Refer back to the syntax table in "The Ingredients" section. Ensure you are using only `-1, 0, 1, or 2` for `match_mode` and `1, -1, 2, or -2` for `search_mode`.
    3.  **Remove Invalid Arguments:** If you're unsure, remove the optional arguments entirely to revert to the default (exact match, first to last search). Then, reintroduce them one by one, verifying correct usage.

### 3. Incorrect Position Returned (Unexpected Approximate Match)

*   **Symptom:** XMATCH returns a position, but it's not the exact item you wanted, or it seems to be an "almost" match.
*   **Cause:** This usually happens when you use `match_mode` of `-1` (exact or next smaller) or `1` (exact or next larger) on an unsorted `lookup_array`. For these approximate match modes to work correctly, the `lookup_array` *must* be sorted in ascending or descending order, respectively. If it's not sorted, XMATCH can return unpredictable results.
*   **Step-by-Step Fix:**
    1.  **Verify `match_mode`:** If you intended an exact match, ensure `match_mode` is `0` or omitted.
    2.  **Sort `lookup_array`:** If you truly need an approximate match (`-1` or `1`), ensure your `lookup_array` is sorted appropriately.
        *   For `match_mode = -1` (exact or next smaller), sort `lookup_array` in **descending** order.
        *   For `match_mode = 1` (exact or next larger), sort `lookup_array` in **ascending** order.
    3.  **Consider `search_mode` for Binary Search:** If using `match_mode = 0` but also specifying `search_mode = 2` or `-2` (binary search), remember that binary searches *also* require the `lookup_array` to be sorted ascending or descending, respectively, even for an exact match.

By understanding these common pitfalls and their solutions, you'll be able to troubleshoot your XMATCH formulas like a pro.

## Quick Reference

| Feature         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
